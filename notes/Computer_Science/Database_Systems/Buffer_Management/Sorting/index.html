<!doctype html>
<html lang='en'>

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-145024207-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-145024207-1');
  </script>
  <meta charset="UTF-8">
  <title>
    
    Keto | Sorting
    
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap time -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <!-- <link href="https://ketozhang.github.io/static/base.css" rel="stylesheet"> -->
  
  <link rel="stylesheet" href="https://ketozhang.github.io/static/main.css">
  <link href=" https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap"
    rel="stylesheet">
  <link href=" https://fonts.googleapis.com/css?family=Roboto|Source+Code+Pro" rel="stylesheet">
  <link href="https://ketozhang.github.io/static/prism.css" rel="stylesheet">
  <link rel="shortcut icon" href="https://ketozhang.github.io/static/favicon.ico">

  <!-- LaTeX Stylesheet -->
  
  <div class="d-none">
    $$
    \newcommand{d}{\mathrm d}
    \newcommand{avg}[1]{\expval{#1}}
        \renewcommand{vec}[1]{\vectorbold{#1}}
        $$
    </div>
    
</head>

<body>
    
<div class="container-fluid" id="note">
  <!-- <nav class="navbar navbar-expand-lg">
        <button id="sidenavCollapse" class="btn btn-info" type="button">
            <i class="fas fa-align-left"></i>
            <span>Toggle Sidebar</span>
        </button>
    </nav> -->
  <div id="note-body" class="row">
    <!-- Notebook Sidenav -->
    <div class="col-3 bg-light pt-1">
      <div class="sidenav sticky-top vh-80">
        <div class="sidenav-header row no-gutters">
          <div class="col-9">
            <strong>Sorting</strong>
          </div>
          <div class="col-2 offset-1">
            <a class="go-up" href="https://ketozhang.github.io/notes/Computer_Science/Database_Systems/Buffer_Management/" role="button">
              <img src="https://img.icons8.com/dotty/80/000000/up.png" style="width: 25px; height: 25px" />
            </a>
          </div>
        </div>
        <div class="sidenav-body no-gutters">
          <ul class="no-list-style pl-3">
            
          </ul>
        </div>
      </div>
    </div>

    <!-- Content -->
    <div class="col-7 col-md-6">
      <h1 class="title text-center pt-3">Sorting</h1>
      
      <div class="markdown-content">
        <h2 id="streaming">Streaming</h2>
<p>Streaming is a strategy to have a function that maps input data from the database into the buffer and outputs it to the RAM and then loads it into the disk.</p>
<ul>
<li><strong>Single-pass:</strong> Simply a single stream of input to output.</li>
<li><strong>Double Buffering:</strong> With two threads, one manages computation and the other manages loading and unloading the buffer.</li>
</ul>
<h2 id="divide-and-conquer">Divide and Conquer</h2>
<h3 id="way-strawman-merge-sort">2-Way Strawman Merge Sort</h3>
<ol type="1">
<li>For each page, sort them in the buffer and write to disk</li>
<li>Now we will read from the disk which now has sorted pages and write this to another disk. We will allocate two input buffers to read two pages and merge them into one. Now the last buffer has two pages.</li>
<li>We continue this with four input buffers, merge then write. Then double up every step.</li>
</ol>
<h2 id="full-external-merge-sort">Full External Merge Sort</h2>
<p>We will now use the strawman sort much more efficiently. Instead of going back and forth we can fully sort <span class="math inline">\(N\)</span> pages with <span class="math inline">\(B &lt; N\)</span> sized buffer.</p>
<ol type="1">
<li>Use <span class="math inline">\(B\)</span> size buffer to read <span class="math inline">\(B\)</span> pages. Continue to do so until <span class="math inline">\(N\)</span> pages are read. Read pages are placed in the allocated to an intermediate disk of <span class="math inline">\(\lceil{N/B}\rceil\)</span> buffers of size <span class="math inline">\(B\)</span>.</li>
<li>In parallel for <span class="math inline">\(B-1\)</span> buffers, are merged and written to the final disk. The amount of block written is <span class="math inline">\(B(B-1)\)</span>.</li>
<li>We continue another pass thru once all <span class="math inline">\(\lceil N/B \rceil\)</span> finish sorting.</li>
</ol>
<ul>
<li><p><strong>Number of passes</strong>: <span class="math display">\[ 1 + \left\lceil \log_{B-1}\left\lceil \frac{N}{B}\right\rceil \right\rceil \]</span></p></li>
<li><p><strong>Cost</strong>: <span class="math display">\[ 2N \cdot \#\text{passes} \]</span></p></li>
<li><p><strong>Two-pass Buffer Required</strong>:</p>
<p><span class="math display">\[ N = B(B-1) \]</span> <span class="math display">\[B \approx \sqrt{N}  \]</span></p></li>
</ul>
<h3 id="problems">Problems</h3>
<ol type="1">
<li><p><strong>Number and Size of Partition</strong></p>
<p>This question is easy when we have to preserve <span class="math inline">\(N\)</span> the number of pages we’re sorting.</p></li>
</ol>
<p><span class="math display">\[
\begin{gather*}
    N = (\text{# partition})(\text{size of partition})\\
    N = P_i \cdot |P_i|\\\\
    P_i = \begin{cases}
        \lceil N/B \rceil &amp; i = 0\\
        \frac{\lceil N/B \rceil}{(B-1)^i} &amp; i &gt; 0
    \end{cases}\\\\
    |P_i| = \begin{cases}
        B &amp; i = 0\\
        B(B-1)^i &amp; i &gt; 0
    \end{cases}
\end{gather*}
\]</span></p>
<h2 id="parallel-sorting">Parallel Sorting</h2>
<p>For <span class="math inline">\(n\)</span> machines we will have <span class="math inline">\(n\)</span> buffers with each buffer dedicated to a range of the data.</p>
<ul>
<li>We’d like each range to have the same amount of values from the data. However if the data is skewed, then this is a problem since one machine has more to do than the others.</li>
</ul>

      </div>
      <!-- Disqus Comments -->
      <div id="disqus_thread" class="mt-5">
        <div class="w-50 mx-auto">
          <button type="button" class="btn btn-block btn-outline-dark show-comments">
            Show Comments
          </button>
        </div>
      </div>
      <!--
                <script>
                /**
                *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
                var disqus_config = function () {
                    this.page.url = "";  // Replace PAGE_URL with your page's canonical URL variable
                    this.page.identifier = "/notes/Computer_Science/Database_Systems/Buffer_Management/Sorting/"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                };
                (function () { // DON'T EDIT BELOW THIS LINE
                    var d = document, s = d.createElement('script');
                    s.src = 'https://ketozhang.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered
                    by Disqus.</a></noscript>
            -->
      
    </div>

    <!-- On This Page -->
    <div class="col-md-3 d-none d-md-block">
      <div class="onthispage sidenav small">
    <div class="sidenav-header">
        <strong>&#9776; On This Page</strong>
    </div>
    <div class="onthispage-collapse">
        <div class="sidenav-body bg-light">
            <ul class="onthispage-list no-list-style"></ul>
        </div>
    </div>
</div>
    </div>
  </div>
</div>

    <footer class="py-2 bg-white">
    <div class="container">
        <p class="text-right m-0"> Generated by <a href="https://github.com/ketozhang/StaticPy">StaticPy</a> |
            Designed
            by <a href="https://github.com/ketozhang">Keto Z.</a>
        </p>
    </div>
</footer>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>

    <script src="https://ketozhang.github.io/static/js/datetime.js"></script>
    <script src="https://ketozhang.github.io/static/js/disqus.js"></script>
    <script src="https://ketozhang.github.io/static/js/codeHighlight.js"></script>
    <script src="https://ketozhang.github.io/static/js/prism.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.js"></script>
    <script src="https://ketozhang.github.io/static/js/onthispage.js"></script>
    <script src="https://ketozhang.github.io/static/js/markdown.js"></script>

    <!-- MathJax -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script src="https://ketozhang.github.io/static/js/mathjax_config.js" defer></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>

    <!-- Bootstrap JS -->
    <!-- TODO: trim JS if not needed -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>


    <!-- Custom Global scripts -->
    <script>
      anchors.add();
      $(document).ready(function () {
        Prism.highlightAll();
      })
    </script>

    <!-- Local scripts -->
    
    
</body>

</html>