name: Deploy Website
on:
  push:
    branches: [ master ]
  schedule:
    - cron:  '0 0 * * *'

jobs:
  publish:
    runs-on: ubuntu-20.04

    steps:
    - uses: actions/checkout@v2

    - uses: actions/setup-python@v2
      with:
        python-version: '3.8.6'

    - uses: abatilo/actions-poetry@v2.0.0
      with:
        poetry-version: 1.1.2

    - name: Install dependencies
      run: poetry install

    - name: Build website
      run: make static
       
    - name: Push
      run: |
        git config --global user.name 'ketozhang'
        git config --global user.email 'keto.zhang@gmail.com'
        git add docs
        git commit -m "[CI] Automatic publish website"
        git push
